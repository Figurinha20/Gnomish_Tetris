<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="X-UA-Compatible" content="ie=edge">
    <title>Document</title>
</head>

<body>
    <canvas id="tetrisCanvas" width="400px" height="920px" style="border:4px solid orange;">
        Your Browser Doesn't Support This
    </canvas>
</body>

<script>
    const canvas = document.querySelector('#tetrisCanvas');
    const ctx = canvas.getContext("2d");

    let H = canvas.height
    let W = canvas.width

    let pieceSize = 40
    let timer = 0

    //Vou fazer as peças para começar
    class Tetronimo {
        constructor() {
            this.randomTetronimo = Math.floor(Math.random() * 7);
            this.y = 0;
            this.fallingMovement = 40
        }

        draw() {
            switch (this.randomTetronimo) {
                case 0:
                    //Peça 4x4
                    ctx.fillStyle = "#f6d009"
                    ctx.strokeStyle = "black"
                    ctx.lineWidth = "3"
                    ctx.beginPath()
                    ctx.moveTo(W / 2 - 40, this.y)
                    ctx.lineTo(W / 2 + 40, this.y)
                    ctx.lineTo(W / 2 + 40, this.y + 80)
                    ctx.lineTo(W / 2 - 40, this.y + 80)
                    ctx.closePath()
                    ctx.fill()
                    ctx.stroke()
                    break;

                case 1:
                    //Peça FINALLY
                    ctx.fillStyle = "#199ce6"
                    ctx.beginPath()
                    ctx.moveTo(W / 2 - 80, this.y)
                    ctx.lineTo(W / 2 + 80, this.y)
                    ctx.lineTo(W / 2 + 80, this.y + 40)
                    ctx.lineTo(W / 2 - 80, this.y + 40)
                    ctx.closePath()
                    ctx.fill()
                    ctx.stroke()


                    break;

                case 2:
                    //Peça S
                    ctx.fillStyle = "#e91680"
                    ctx.beginPath()
                    ctx.moveTo(W / 2 + 80, this.y)
                    ctx.lineTo(W / 2, this.y)
                    ctx.lineTo(W / 2, this.y + 40)
                    ctx.lineTo(W / 2 - 40, this.y + 40)
                    ctx.lineTo(W / 2 - 40, this.y + 80)
                    ctx.lineTo(W / 2 + 40, this.y + 80)
                    ctx.lineTo(W / 2 + 40, this.y + 40)
                    ctx.lineTo(W / 2 + 80, this.y + 40)
                    ctx.closePath()
                    ctx.fill()
                    ctx.stroke()

                    break;

                case 3:
                    //Peça Z
                    ctx.fillStyle = "#16e97f"
                    ctx.beginPath()
                    ctx.moveTo(W / 2 - 80, this.y)
                    ctx.lineTo(W / 2, this.y)
                    ctx.lineTo(W / 2, this.y + 40)
                    ctx.lineTo(W / 2 + 40, this.y + 40)
                    ctx.lineTo(W / 2 + 40, this.y + 80)
                    ctx.lineTo(W / 2 - 40, this.y + 80)
                    ctx.lineTo(W / 2 - 40, this.y + 40)
                    ctx.lineTo(W / 2 - 80, this.y + 40)
                    ctx.closePath()
                    ctx.fill()
                    ctx.stroke()

                    break;
                case 4:
                    //Peça L
                    ctx.fillStyle = "#E21D29"
                    ctx.beginPath()
                    ctx.moveTo(W / 2 - 40, this.y)
                    ctx.lineTo(W / 2 - 40, this.y + 120)
                    ctx.lineTo(W / 2 + 40, this.y + 120)
                    ctx.lineTo(W / 2 + 40, this.y + 80)
                    ctx.lineTo(W / 2, this.y + 80)
                    ctx.lineTo(W / 2, this.y)
                    ctx.closePath()
                    ctx.fill()
                    ctx.stroke()

                    break;
                case 5:
                    //Peça J
                    ctx.fillStyle = "#1DE2D6"
                    ctx.beginPath()
                    ctx.moveTo(W / 2 + 40, this.y)
                    ctx.lineTo(W / 2 + 40, this.y + 120)
                    ctx.lineTo(W / 2 - 40, this.y + 120)
                    ctx.lineTo(W / 2 - 40, this.y + 80)
                    ctx.lineTo(W / 2, this.y + 80)
                    ctx.lineTo(W / 2, this.y)
                    ctx.closePath()
                    ctx.fill()
                    ctx.stroke()

                    break;
                case 6:
                    //Peça T
                    ctx.fillStyle = "#A711EE"
                    ctx.beginPath()
                    ctx.moveTo(W / 2 - 40, this.y)
                    ctx.lineTo(W / 2 + 80, this.y)
                    ctx.lineTo(W / 2 + 80, this.y + 40)
                    ctx.lineTo(W / 2 + 40, this.y + 40)
                    ctx.lineTo(W / 2 + 40, this.y + 80)
                    ctx.lineTo(W / 2, this.y + 80)
                    ctx.lineTo(W / 2, this.y + 40)
                    ctx.lineTo(W / 2 - 40, this.y + 40)
                    ctx.closePath()
                    ctx.fill()
                    ctx.stroke()

                    break;
                default:
                    alert("oi?")
                    break;
            }
        }
        update() {
            timer++
            if (timer == 50) {
                this.y += this.fallingMovement
                timer = 0
            }
        }
    }

    let gameArray = new Array();
    for (let i = 0; i < 1; i++) {
        gameArray.push(new Tetronimo())
    }

    function render() {
        //clear canvas
        ctx.fillStyle = "rgba(255, 255, 255)"
        ctx.fillRect(0, 0, W, H)

        //draw GRID
        for (var x = 0; x < W; x += 40) {
            ctx.moveTo(x, 0);
            ctx.lineTo(x, H);
        }

        for (var y = 0; y < H; y += 40) {
            ctx.moveTo(0, y);
            ctx.lineTo(W, y);
        }

        ctx.strokeStyle = "#FCE3BF";
        ctx.stroke();

        ctx.strokeStyle = "black"
        ctx.lineWidth = "3"

        //draw & update
        gameArray.forEach(function (tetronimo) {
            tetronimo.draw();
            tetronimo.update();
        });

        window.requestAnimationFrame(render)
    }

    render();
</script>

</html>